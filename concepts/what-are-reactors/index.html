<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Reactors - Basis Theory Guides</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Reactors | Basis Theory Guides</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Reactors" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Explore step-by-step guides to use our APIs and SDKs." /> <meta property="og:description" content="Explore step-by-step guides to use our APIs and SDKs." /> <link rel="canonical" href="https://developers.basistheory.com/concepts/what-are-reactors/" /> <meta property="og:url" content="https://developers.basistheory.com/concepts/what-are-reactors/" /> <meta property="og:site_name" content="Basis Theory Guides" /> <meta property="og:image" content="https://cdn.basistheory.com/images/seo/guides-opengraph.png" /> <meta property="og:image:height" content="630" /> <meta property="og:image:width" content="1200" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://cdn.basistheory.com/images/seo/guides-opengraph.png" /> <meta property="twitter:title" content="Reactors" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Explore step-by-step guides to use our APIs and SDKs.","headline":"Reactors","image":{"width":1200,"height":630,"url":"https://cdn.basistheory.com/images/seo/guides-opengraph.png","@type":"imageObject"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://developers.basistheory.com/assets/images/logos-guides.svg"}},"url":"https://developers.basistheory.com/concepts/what-are-reactors/"}</script> <!-- End Jekyll SEO tag --> </head> <script defer data-api="https://analytics.basistheory.com/api/event" data-domain="developers.basistheory.com" src="https://cdn.basistheory.com/javascript/analytics.js"></script> <!-- Google Tag Manager --> <script>(function (w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-M56229L');</script> <!-- End Google Tag Manager --> <!-- Iubenda --> <script type="text/javascript"> var _iub = _iub || []; _iub.csConfiguration = { "ccpaAcknowledgeOnLoad": true, "consentOnContinuedBrowsing": false, "countryDetection": true, "gdprAppliesGlobally": false, "lang": "en", "siteId": 2378844, "cookiePolicyId": 13137791, "callback": { "onPreferenceExpressedOrNotNeeded": function (preference) { dataLayer.push({ iubenda_ccpa_opted_out: _iub.cs.api.isCcpaOptedOut() }); if (!preference) { dataLayer.push({ event: "iubenda_preference_not_needed" }); } else { if (preference.consent === true) { dataLayer.push({ event: "iubenda_consent_given" }); } else if (preference.consent === false) { dataLayer.push({ event: "iubenda_consent_rejected" }); } else if (preference.purposes) { for (var purposeId in preference.purposes) { if (preference.purposes[purposeId]) { dataLayer.push({ event: "iubenda_consent_given_purpose_" + purposeId }); } } } } } }, "banner": { "acceptButtonCaptionColor": "#070a1b", "acceptButtonColor": "#1ad1db", "acceptButtonDisplay": true, "backgroundColor": "#141729", "closeButtonDisplay": false, "customizeButtonCaptionColor": "#d2d2d2", "customizeButtonColor": "#1a1e32", "customizeButtonDisplay": true, "position": "bottom", "rejectButtonCaptionColor": "white", "rejectButtonColor": "#1e2337", "rejectButtonDisplay": true, "textColor": "#e5e6ec", "acceptButtonCaption": "Accept All", "content": "<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossOrigin=\"true\" />\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap\" rel=\"stylesheet\" />\n<style>\ndiv#iubenda-cs-banner {\n font-size: 16px !important;\n font-family: 'Inter', sans-serif, -apple-system, sans-serif !important;\n}\n\ndiv#iubenda-cs-banner div.iubenda-cs-container {\n border-top: 1px solid #2f3244 !important;\n}\n\ndiv#iubenda-cs-banner .iubenda-banner-content {\n font-family: 'Inter', sans-serif, -apple-system, sans-serif !important;\n font-weight: 400 !important;\n color: #8389a6 !important;\n font-size: 14px !important; \n}\n\ndiv#iubenda-cs-title {\n color: #E5E6EC !important;\n font-size: 16px !important;\n}\n\ndiv#iubenda-cs-banner div.iubenda-cs-opt-group button {\n padding: 12px 32px !important;\n font-weight: 600 !important;\n border-radius: 4px !important;\n}\n\nbutton.iubenda-cs-accept-btn {\n box-shadow: 1px 1px 3px 0 rgb(49 255 255 / 30%), inset 0 0 0 1px hsl(0deg 0% 100% / 40%);\n margin-left: 16px !important;\n}\n\n@media (min-width: 992px) {\n #iubenda-cs-banner.iubenda-cs-default div.iubenda-cs-rationale {\n max-width: 1200px !important;\n width: 100% !important;\n }\n}\n</style><div id=\"iubenda-cs-title\">&#x1f36a; &nbsp;Cookie Notice</div><div id=\"iubenda-cs-paragraph\">\n\nBy clicking \"Accept All\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our <a href=\"https://basistheory.com/privacy-policy\" target=\"_blank\">Cookie Policy</a> for more information.\n</div>", "rejectButtonCaption": "" } }; </script> <script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script> <!-- End Iubenda --> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path> <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle> <line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line> <line x1="3" y1="6" x2="21" y2="6"></line> <line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path> <polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <header class="site-header"> <a class="site-header-logo" href="https://developers.basistheory.com/"> </a> <div class="documentation-links"> <a class="documentation-link " href="/getting-started">Get Started</a> <a class="documentation-link active" href="/">Documentation</a> <a class="documentation-link" href="https://docs.basistheory.com/api-reference/#introduction">API Reference</a> <a class="documentation-link" href="https://docs.basistheory.com/elements/#introduction">Elements</a> </div> <div class="portal-links"> <a class="portal-sign-in" href="https://portal.basistheory.com">Sign In</a> <a class="portal-create-account" href="https://portal.basistheory.com/register">Create Account</a> </div> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"> <use xlink:href="#svg-menu"></use> </svg> </a> </header> <div class="side-bar"> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-list"><a class="side-bar-category home-link" href="/"> <div class="icon-and-category-name"> <div class="home-icon category-icon-spacing "></div> <div class="side-bar-category-name home-link ">Home</div> </div> </a> <div class="side-bar-category" id="getting-started-category-name-and-icon"> <div class="icon-and-category-name"> <div class="getting-started-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Getting Started</div> </div> <a class="category-expander" id="getting-started-category-expander"></a> </div> <div class="side-bar-category-items" id="getting-started-category-items"><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-curl/" class="nav-list-link ">Quickstart with cURL</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-nodejs/" class="nav-list-link ">Quickstart with Node.js</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-python/" class="nav-list-link ">Quickstart with Python</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-ruby/" class="nav-list-link ">Quickstart with Ruby</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-dotnet/" class="nav-list-link ">Quickstart with .NET</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-java/" class="nav-list-link ">Quickstart with Java</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-go/" class="nav-list-link ">Quickstart with Go</a> </div></div> <div class="side-bar-category" id="blueprints-category-name-and-icon"> <div class="icon-and-category-name"> <div class="blueprints-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Blueprints</div> </div> <a class="category-expander" id="blueprints-category-expander"></a> </div> <div class="side-bar-category-items" id="blueprints-category-items"><div class="nav-list-item"> <a href="https://developers.basistheory.com/blueprints/pci/" class="nav-list-link ">PCI Blueprint</a> </div></div> <div class="side-bar-category" id="concepts-category-name-and-icon"> <div class="icon-and-category-name"> <div class="concepts-icon category-icon-spacing active"></div> <div class="side-bar-category-name active">Concepts</div> </div> <a class="category-expander" id="concepts-category-expander"></a> </div> <div class="side-bar-category-items" id="concepts-category-items"><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-tokens/" class="nav-list-link ">Tokens</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-token-containers/" class="nav-list-link ">Token Containers</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/access-controls/" class="nav-list-link ">Access Controls</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-is-the-proxy/" class="nav-list-link ">Proxy</a> </div><div class="nav-list-item active"> <a href="https://developers.basistheory.com/concepts/what-are-reactors/" class="nav-list-link active">Reactors</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-is-search/" class="nav-list-link ">Search</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-mats/" class="nav-list-link ">Monthly Active Tokens</a> </div></div> <div class="side-bar-category" id="guides-category-name-and-icon"> <div class="icon-and-category-name"> <div class="guides-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Guides</div> </div> <a class="category-expander" id="guides-category-expander"></a> </div> <div class="side-bar-category-items" id="guides-category-items"> <div class="guide-subcategory-title">SECURE YOUR DATA</div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-pii-js/" class="nav-list-link ">Collect Customer Data (PII) with JavaScript</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-pii-react/" class="nav-list-link ">Collect Customer Data (PII) with React</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-cards-with-elements-react/" class="nav-list-link ">Collect Credit Cards with React</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/style-elements-for-my-brand/" class="nav-list-link ">Styling Elements</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/encrypt-us-banks-in-your-applications/" class="nav-list-link ">Encrypt U.S. Banks in your applications</a> </div><div class="guide-subcategory-title">USE YOUR DATA</div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-cards-with-elements/" class="nav-list-link ">Collect and Charge Credit Cards with JavaScript</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/use-us-bank-accounts-without-touching-them/" class="nav-list-link ">Use U.S. Bank Accounts without touching them</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/reveal-cards-with-react/" class="nav-list-link ">Reveal Card Data with React</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/use-token-data-in-reactors/" class="nav-list-link ">Use Token Data in Reactors</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/use-token-data-in-http-requests/" class="nav-list-link ">Use Token Data in HTTP Requests</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/run-your-own-code-in-a-reactor/" class="nav-list-link ">Run Your Own Code in a Reactor</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-cards-with-proxies/" class="nav-list-link ">Collect and Use Credit Cards with Proxies</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/migrating-off-basis-theory/" class="nav-list-link ">Migrating off Basis Theory</a> </div><div class="guide-subcategory-title">MANAGE YOUR DATA</div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/manage-applications-with-terraform/" class="nav-list-link ">Manage Applications with Terraform</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/manage-reactor-formulas-with-terraform/" class="nav-list-link ">Manage Reactor Formulas with Terraform</a> </div></div> <div class="side-bar-category" id="reference-category-name-and-icon"> <div class="icon-and-category-name"> <div class="reference-icon category-icon-spacing"></div> <div class="side-bar-category-name">Reference</div> </div> <a class="category-expander" id="reference-category-expander"></a> </div> <div class="side-bar-category-items" id="reference-category-items"> <div class="nav-list-item"> <a href="https://docs.basistheory.com/api-reference/#introduction" class="nav-list-link">API Reference</a> <a href="https://status.basistheory.com" target="_blank" class="nav-list-link">System Status</a> <a href="https://docs.basistheory.com/elements/#introduction" class="nav-list-link">Elements</a> <a href="https://docs.basistheory.com/expressions/#introduction" class="nav-list-link">Expressions</a> </div> </div> <a class="side-bar-category" href="/labs"> <div class="icon-and-category-name"> <div class="labs-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Basis Theory Labs</div> </div> </a> </div> </nav> <footer class="site-footer"> </footer> </div> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Basis Theory Guides" aria-label="Search Basis Theory Guides" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"> <use xlink:href="#svg-search"></use> </svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main" id="top"> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="reactors">Reactors</h1> <p>A Reactor is a serverless compute service allowing Node.js code hosted in Basis Theory to be executed against your tokens completely isolated away from your application and systems.</p> <p>Reactors are invokable from any system that has the ability to make HTTPS requests and access the internet.</p> <h2 id="how-it-works"><strong>How It Works</strong></h2> <p>Reactors are serverless function runtimes, similar to AWS Lambda, Azure Functions, or Cloudflare Workers - except your applications, systems, and infrastructure never touches the sensitive plaintext data.</p> <p><img src="/assets/images/concepts/reactors_overview.png" /></p> <h2 id="reactor-formulas">Reactor Formulas</h2> <p>Using a Reactor starts with the code you’d like to execute within your system, this code template is referred to as a Reactor Formula. When creating a Reactor Formula you will define the <code class="language-plaintext highlighter-rouge">code</code>, expected request parameters, and any up-front configuration - like secrets - required to execute your function. Find <em>an exhaustive list of all configuration options in our <a href="https://docs.basistheory.com/?shell#reactor-formulas-reactor-formula-object">Reactor Formula API Reference.</a></em></p> <p>Formulas provide two different response types, giving the flexibility of securing data or returning it as a raw response:</p> <ul> <li><code class="language-plaintext highlighter-rouge">tokenize</code> <ul> <li>Any object passed will be <a href="https://docs.basistheory.com/#tokenize">tokenized</a>.</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">raw</code> <ul> <li>Any object passed will be returned from the HTTP request that invoked the Reactor.</li> </ul> </li> </ul> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// code to execute</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">tokenize</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">bar</span><span class="p">:</span> <span class="dl">'</span><span class="s1">secret</span><span class="dl">'</span> <span class="c1">// will be tokenized</span>
    <span class="p">},</span>
    <span class="na">raw</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">foo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">plaintext</span><span class="dl">'</span> <span class="c1">// will be returned in plaintext</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div> <p><span class="base-alert info"> <span> <strong>Quickstart hint:</strong> Find a list of our fully compliant and maintained Official Reactor Formulas from within our <a href="https://portal.basistheory.com/reactors/formulas">Portal</a> </span> </span></p> <h2 id="creating-a-reactor">Creating a Reactor</h2> <p>Reactors are created with our <a href="https://docs.basistheory.com/#reactors-create-reactor">Create Reactor endpoint</a>. Once configured each Reactor can be invoked - executing the formula it has been configured with. Creating a new Reactor is as simple as passing in the configuration and Formula to be invoked.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"https://api.basistheory.com/reactors"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"BT-API-KEY: &lt;API_KEY_HERE&gt;"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
    "name": "My First Reactor",
    "configuration": {
      "SERVICE_API_KEY": "key_abcd1234"
    },
    "formula": {
      "id": "17069df1-80f4-439e-86a7-4121863e4678"
    }
  }'</span>
</code></pre></div></div> <p><span class="base-alert info"> <span> We encrypt and store each configuration setting in our secure PCI Level 1 and SOC2 environment. </span> </span></p> <h2 id="invoking-a-reactor">Invoking a Reactor</h2> <p>Reactors may be invoked by an Application with <code class="language-plaintext highlighter-rouge">token:use</code> permission, which enables the Reactor to detokenize tokens provided in the request <code class="language-plaintext highlighter-rouge">args</code>. It is recommended that you restrict which tokens a Reactor can detokenize by only granting <code class="language-plaintext highlighter-rouge">token:use</code> permission on the most-specific <a href="/concepts/what-are-token-containers">container</a> of tokens that is required.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"https://api.basistheory.com/reactors/5b493235-6917-4307-906a-2cd6f1a90b13/react"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"BT-API-KEY: key_N88mVGsp3sCXkykyN2EFED"</span> <span class="se">\</span>
  <span class="nt">-X</span> <span class="s2">"POST"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
    "args": {
      "card": "",
      "customer_id": "myCustomerId1234"
    }
  }'</span>
</code></pre></div></div> <hr /> <h2 id="common-use-cases"><strong>Common Use Cases</strong></h2> <h3 id="call-a-3rd-party">Call a 3rd party</h3> <p>Depending on how complex your use case is a Reactor may provide you with an excellent opportunity to mutate data before forwarding it onto a 3rd Party. In the below example, we call httpbin.org (an echo service) with the last 4 characters of our token:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">node-fetch</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">customer_id</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">last4</span> <span class="o">=</span> <span class="nx">customer_id</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://httpbin.org/post</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span> <span class="na">body</span><span class="p">:</span> <span class="nx">last4</span><span class="p">});</span>
  <span class="kd">const</span> <span class="nx">raw</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">raw</span><span class="p">,</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div> <h3 id="create-a-pdf-document">Create a pdf document</h3> <p>Creating documents out of sensitive data is a primary need for businesses today, especially in fintech where you need to create and submit 1099s for many businesses:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">node-fetch</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">PDFDocument</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">pdfkit</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="na">token</span><span class="p">:</span> <span class="p">{</span> <span class="nx">data</span> <span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>
  
  <span class="kd">let</span> <span class="nx">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDFDocument</span><span class="p">;</span>
  <span class="nx">doc</span><span class="p">.</span><span class="nx">fontSize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">`Some token data on a pdf: </span><span class="p">${</span><span class="nx">data</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="nx">doc</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
  
  <span class="c1">//Send or upload file to your partner</span>
  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://httpbin.org/post</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span> <span class="na">body</span><span class="p">:</span> <span class="nx">doc</span><span class="p">});</span>
  <span class="kd">const</span> <span class="nx">raw</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">raw</span><span class="p">,</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div> <h3 id="generate-a-text-file-and-send-to-an-sftp-server">Generate a text file and send to an SFTP server</h3> <p>Many legacy business process still rely heavily on comma delimited files (CSV), tab delimited files or space-delimited files to transport data between companies, typically using SFTP servers as the endpoint of this data. For example, engaging with partner banks with ACH files requires you to format your file correctly and drop it on to an SFTP server.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">fs</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="p">{</span><span class="nx">Client</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ssh2</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="na">token</span><span class="p">:</span> <span class="p">{</span> <span class="p">{</span> <span class="nx">prop1</span><span class="p">,</span> <span class="nx">prop2</span><span class="p">,</span> <span class="nx">prop3</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">host</span><span class="p">,</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">configuration</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">connSettings</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">host</span><span class="p">,</span> <span class="na">port</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">};</span>  
  <span class="kd">var</span> <span class="nx">conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">conn</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ready</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">conn</span><span class="p">.</span><span class="nx">sftp</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">sftp</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">bufferStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">stream</span><span class="dl">'</span><span class="p">).</span><span class="nx">PassThrough</span><span class="p">();</span>
        <span class="nx">bufferStream</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">prop1</span><span class="p">}</span><span class="s2">,</span><span class="p">${</span><span class="nx">prop2</span><span class="p">}</span><span class="s2">,</span><span class="p">${</span><span class="nx">prop3</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">"</span><span class="s2">utf-8</span><span class="dl">"</span><span class="p">));</span>
        
        <span class="kd">const</span> <span class="nx">writeStream</span> <span class="o">=</span>  <span class="nx">sftp</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span> <span class="dl">"</span><span class="s2">test.csv</span><span class="dl">"</span><span class="p">);</span>
        
        <span class="nx">writeStream</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">});</span>
          <span class="nx">resolve</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="nx">bufferStream</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">writeStream</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}).</span><span class="nx">connect</span><span class="p">(</span><span class="nx">connSettings</span><span class="p">));</span>
  <span class="p">};</span>
</code></pre></div></div> <h3 id="import-file-from-a-partner">Import file from a partner</h3> <p>When you need to process files of sensitive data without it touching your systems, use a Reactor to desensitize a file before forwarding it on to your systems for your own logic:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">BasisTheory</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@basis-theory/basis-theory-js</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">fileString</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span> <span class="c1">// "name,ssn\nTheory,555445555"</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">BT_API_KEY</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">configuration</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">bt</span> <span class="o">=</span> <span class="k">await</span> <span class="k">new</span> <span class="nx">BasisTheory</span><span class="p">().</span><span class="nx">init</span><span class="p">(</span><span class="nx">BT_API_KEY</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">fileString</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">));</span>

  <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">rows</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">row</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">bt</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">social_security_number</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">token</span> <span class="o">=&gt;</span> <span class="nx">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
  <span class="p">}));</span>

  <span class="kd">const</span> <span class="nx">desensitizedFile</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">row</span> <span class="o">=&gt;</span> <span class="nx">row</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">)).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="na">raw</span><span class="p">:</span> <span class="nx">desensitizedFile</span><span class="p">});</span> <span class="c1">// "name,ssn\nTheory,14f5c8d4-3e84-4185-96ac-fac6386614dc"</span>
<span class="p">};</span>
</code></pre></div></div> <h3 id="anything-you-can-imagine">Anything you can imagine</h3> <p>When our templates and examples aren’t enough, we enable you to build anything you want to with our Reactors. Start with a blank function like the one below and solve any business problem with the data you need:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">tokens</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>

  <span class="c1">// Anything you can dream up 💭</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">tokenize</span><span class="p">:</span> <span class="p">{</span> <span class="na">foo</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span> <span class="p">},</span> <span class="c1">// tokenize data</span>
    <span class="na">raw</span><span class="p">:</span> <span class="p">{</span> <span class="na">foo</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span><span class="p">}</span> <span class="c1">// return any data</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div> <hr /> <h2 id="faq">FAQ:</h2> <h3 id="when-do-i-use-a-reactor">When do I use a Reactor?</h3> <p>When you’re required to write your own code to solve more complex problems - for example when needing to manipulate the data, create a document, or import a file from a partner.</p> <h3 id="when-would-i-use-the-proxy-instead-of-a-reactor">When would I use the Proxy instead of a Reactor?</h3> <p>When making a simple HTTP request, a simpler implementation can be created using the Proxy.</p> <h3 id="what-does-the-development-lifecycle-look-like-for-building-reactors">What does the development lifecycle look like for building Reactors?</h3> <p>Each Reactor runs a single function which can be scoped, coded, and tested all within your normal development tooling and lifecycles. Code written and pushed to your own Github repositories can be used to create new Reactor Formulas using our Terraform Provider or <a href="https://docs.basistheory.com/#reactor-formulas-reactor-formula-object">API</a> integrations.</p> <h3 id="can-we-run-the-reactor-code-locally-to-test">Can we run the reactor code locally to test?</h3> <p>Absolutely, each function you write for your Reactors can be run and tested locally. This code can be treated exactly the same as the existing application code you’re deploying to other infrastructure.</p> <h3 id="is-there-a-cold-start-spin-up-time-for-reactors">Is there a cold start spin-up time for Reactors?</h3> <p>Our Reactors are designed to be always hot - which allows for fast execution with little spin-up time.</p> <h3 id="is-there-a-concept-of-sandbox-reactors">Is there a concept of “sandbox” Reactors?</h3> <p>Our Reactors follow the same development lifecycle as the rest of our platform, allowing you to create a new Tenant to handle any testing of your platform from your staging or development environments.</p> <h3 id="what-are-the-ip-addresses-for-bt">What are the IP addresses for BT?</h3> <p>We have the list of our public <a href="https://docs.basistheory.com/#ip_addersses">IP addresses here</a>.</p> <h3 id="how-can-reactors-reduce-the-pci-compliance-scope-of-my-application">How can Reactors reduce the PCI compliance scope of my application?</h3> <p>Using our Reactors allows you to execute code against any PCI classified data, enabling your infrastructure to stay out of PCI compliance.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
