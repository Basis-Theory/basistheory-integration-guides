<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Run Your Own Code in a Reactor - Basis Theory Guides</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Run Your Own Code in a Reactor | Basis Theory Guides</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Run Your Own Code in a Reactor" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Explore step-by-step guides to use our APIs and SDKs." /> <meta property="og:description" content="Explore step-by-step guides to use our APIs and SDKs." /> <link rel="canonical" href="https://developers.basistheory.com/guides/run-your-own-code-in-a-reactor/" /> <meta property="og:url" content="https://developers.basistheory.com/guides/run-your-own-code-in-a-reactor/" /> <meta property="og:site_name" content="Basis Theory Guides" /> <meta property="og:image" content="https://cdn.basistheory.com/images/seo/guides-opengraph.png" /> <meta property="og:image:height" content="630" /> <meta property="og:image:width" content="1200" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://cdn.basistheory.com/images/seo/guides-opengraph.png" /> <meta property="twitter:title" content="Run Your Own Code in a Reactor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Explore step-by-step guides to use our APIs and SDKs.","headline":"Run Your Own Code in a Reactor","image":{"width":1200,"height":630,"url":"https://cdn.basistheory.com/images/seo/guides-opengraph.png","@type":"imageObject"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://developers.basistheory.com/assets/images/logos-guides.svg"}},"url":"https://developers.basistheory.com/guides/run-your-own-code-in-a-reactor/"}</script> <!-- End Jekyll SEO tag --> </head> <script defer data-api="https://analytics.basistheory.com/api/event" data-domain="developers.basistheory.com" src="https://cdn.basistheory.com/javascript/analytics.js"></script> <!-- Google Tag Manager --> <script>(function (w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-M56229L');</script> <!-- End Google Tag Manager --> <!-- Iubenda --> <script type="text/javascript"> var _iub = _iub || []; _iub.csConfiguration = { "ccpaAcknowledgeOnLoad": true, "consentOnContinuedBrowsing": false, "countryDetection": true, "gdprAppliesGlobally": false, "lang": "en", "siteId": 2378844, "cookiePolicyId": 13137791, "callback": { "onPreferenceExpressedOrNotNeeded": function (preference) { dataLayer.push({ iubenda_ccpa_opted_out: _iub.cs.api.isCcpaOptedOut() }); if (!preference) { dataLayer.push({ event: "iubenda_preference_not_needed" }); } else { if (preference.consent === true) { dataLayer.push({ event: "iubenda_consent_given" }); } else if (preference.consent === false) { dataLayer.push({ event: "iubenda_consent_rejected" }); } else if (preference.purposes) { for (var purposeId in preference.purposes) { if (preference.purposes[purposeId]) { dataLayer.push({ event: "iubenda_consent_given_purpose_" + purposeId }); } } } } } }, "banner": { "acceptButtonCaptionColor": "#070a1b", "acceptButtonColor": "#1ad1db", "acceptButtonDisplay": true, "backgroundColor": "#141729", "closeButtonDisplay": false, "customizeButtonCaptionColor": "#d2d2d2", "customizeButtonColor": "#1a1e32", "customizeButtonDisplay": true, "position": "bottom", "rejectButtonCaptionColor": "white", "rejectButtonColor": "#1e2337", "rejectButtonDisplay": true, "textColor": "#e5e6ec", "acceptButtonCaption": "Accept All", "content": "<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossOrigin=\"true\" />\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap\" rel=\"stylesheet\" />\n<style>\ndiv#iubenda-cs-banner {\n font-size: 16px !important;\n font-family: 'Inter', sans-serif, -apple-system, sans-serif !important;\n}\n\ndiv#iubenda-cs-banner div.iubenda-cs-container {\n border-top: 1px solid #2f3244 !important;\n}\n\ndiv#iubenda-cs-banner .iubenda-banner-content {\n font-family: 'Inter', sans-serif, -apple-system, sans-serif !important;\n font-weight: 400 !important;\n color: #8389a6 !important;\n font-size: 14px !important; \n}\n\ndiv#iubenda-cs-title {\n color: #E5E6EC !important;\n font-size: 16px !important;\n}\n\ndiv#iubenda-cs-banner div.iubenda-cs-opt-group button {\n padding: 12px 32px !important;\n font-weight: 600 !important;\n border-radius: 4px !important;\n}\n\nbutton.iubenda-cs-accept-btn {\n box-shadow: 1px 1px 3px 0 rgb(49 255 255 / 30%), inset 0 0 0 1px hsl(0deg 0% 100% / 40%);\n margin-left: 16px !important;\n}\n\n@media (min-width: 992px) {\n #iubenda-cs-banner.iubenda-cs-default div.iubenda-cs-rationale {\n max-width: 1200px !important;\n width: 100% !important;\n }\n}\n</style><div id=\"iubenda-cs-title\">&#x1f36a; &nbsp;Cookie Notice</div><div id=\"iubenda-cs-paragraph\">\n\nBy clicking \"Accept All\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our <a href=\"https://basistheory.com/privacy-policy\" target=\"_blank\">Cookie Policy</a> for more information.\n</div>", "rejectButtonCaption": "" } }; </script> <script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script> <!-- End Iubenda --> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path> <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle> <line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line> <line x1="3" y1="6" x2="21" y2="6"></line> <line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path> <polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <header class="site-header"> <a class="site-header-logo" href="https://developers.basistheory.com/"> </a> <div class="documentation-links"> <a class="documentation-link " href="/getting-started">Get Started</a> <a class="documentation-link active" href="/">Documentation</a> <a class="documentation-link" href="https://docs.basistheory.com/api-reference/#introduction">API Reference</a> <a class="documentation-link" href="https://docs.basistheory.com/elements/#introduction">Elements</a> </div> <div class="portal-links"> <a class="portal-sign-in" href="https://portal.basistheory.com">Sign In</a> <a class="portal-create-account" href="https://portal.basistheory.com/register">Create Account</a> </div> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"> <use xlink:href="#svg-menu"></use> </svg> </a> </header> <div class="side-bar"> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-list"><a class="side-bar-category home-link" href="/"> <div class="icon-and-category-name"> <div class="home-icon category-icon-spacing "></div> <div class="side-bar-category-name home-link ">Home</div> </div> </a> <div class="side-bar-category" id="getting-started-category-name-and-icon"> <div class="icon-and-category-name"> <div class="getting-started-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Getting Started</div> </div> <a class="category-expander" id="getting-started-category-expander"></a> </div> <div class="side-bar-category-items" id="getting-started-category-items"><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-curl/" class="nav-list-link ">Quickstart with cURL</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-nodejs/" class="nav-list-link ">Quickstart with Node.js</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-python/" class="nav-list-link ">Quickstart with Python</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-ruby/" class="nav-list-link ">Quickstart with Ruby</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-dotnet/" class="nav-list-link ">Quickstart with .NET</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-java/" class="nav-list-link ">Quickstart with Java</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/getting-started/quickstart-with-go/" class="nav-list-link ">Quickstart with Go</a> </div></div> <div class="side-bar-category" id="blueprints-category-name-and-icon"> <div class="icon-and-category-name"> <div class="blueprints-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Blueprints</div> </div> <a class="category-expander" id="blueprints-category-expander"></a> </div> <div class="side-bar-category-items" id="blueprints-category-items"><div class="nav-list-item"> <a href="https://developers.basistheory.com/blueprints/pci/" class="nav-list-link ">PCI Blueprint</a> </div></div> <div class="side-bar-category" id="concepts-category-name-and-icon"> <div class="icon-and-category-name"> <div class="concepts-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Concepts</div> </div> <a class="category-expander" id="concepts-category-expander"></a> </div> <div class="side-bar-category-items" id="concepts-category-items"><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-tokens/" class="nav-list-link ">Tokens</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-token-containers/" class="nav-list-link ">Token Containers</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/access-controls/" class="nav-list-link ">Access Controls</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-is-the-proxy/" class="nav-list-link ">Proxy</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-reactors/" class="nav-list-link ">Reactors</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-is-search/" class="nav-list-link ">Search</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/concepts/what-are-mats/" class="nav-list-link ">Monthly Active Tokens</a> </div></div> <div class="side-bar-category" id="guides-category-name-and-icon"> <div class="icon-and-category-name"> <div class="guides-icon category-icon-spacing active"></div> <div class="side-bar-category-name active">Guides</div> </div> <a class="category-expander" id="guides-category-expander"></a> </div> <div class="side-bar-category-items" id="guides-category-items"> <div class="guide-subcategory-title">SECURE YOUR DATA</div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-pii-js/" class="nav-list-link ">Collect Customer Data (PII) with JavaScript</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-pii-react/" class="nav-list-link ">Collect Customer Data (PII) with React</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-cards-with-elements-react/" class="nav-list-link ">Collect Credit Cards with React</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/style-elements-for-my-brand/" class="nav-list-link ">Styling Elements</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/encrypt-us-banks-in-your-applications/" class="nav-list-link ">Encrypt U.S. Banks in your applications</a> </div><div class="guide-subcategory-title">USE YOUR DATA</div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-cards-with-elements/" class="nav-list-link ">Collect and Charge Credit Cards with JavaScript</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/use-us-bank-accounts-without-touching-them/" class="nav-list-link ">Use U.S. Bank Accounts without touching them</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/reveal-cards-with-react/" class="nav-list-link ">Reveal Card Data with React</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/use-token-data-in-reactors/" class="nav-list-link ">Use Token Data in Reactors</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/use-token-data-in-http-requests/" class="nav-list-link ">Use Token Data in HTTP Requests</a> </div><div class="nav-list-item active"> <a href="https://developers.basistheory.com/guides/run-your-own-code-in-a-reactor/" class="nav-list-link active">Run Your Own Code in a Reactor</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/collect-cards-with-proxies/" class="nav-list-link ">Collect and Use Credit Cards with Proxies</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/migrating-off-basis-theory/" class="nav-list-link ">Migrating off Basis Theory</a> </div><div class="guide-subcategory-title">MANAGE YOUR DATA</div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/manage-applications-with-terraform/" class="nav-list-link ">Manage Applications with Terraform</a> </div><div class="nav-list-item"> <a href="https://developers.basistheory.com/guides/manage-reactor-formulas-with-terraform/" class="nav-list-link ">Manage Reactor Formulas with Terraform</a> </div></div> <div class="side-bar-category" id="reference-category-name-and-icon"> <div class="icon-and-category-name"> <div class="reference-icon category-icon-spacing"></div> <div class="side-bar-category-name">Reference</div> </div> <a class="category-expander" id="reference-category-expander"></a> </div> <div class="side-bar-category-items" id="reference-category-items"> <div class="nav-list-item"> <a href="https://docs.basistheory.com/api-reference/#introduction" class="nav-list-link">API Reference</a> <a href="https://status.basistheory.com" target="_blank" class="nav-list-link">System Status</a> <a href="https://docs.basistheory.com/elements/#introduction" class="nav-list-link">Elements</a> <a href="https://docs.basistheory.com/expressions/#introduction" class="nav-list-link">Expressions</a> </div> </div> <a class="side-bar-category" href="/labs"> <div class="icon-and-category-name"> <div class="labs-icon category-icon-spacing "></div> <div class="side-bar-category-name ">Basis Theory Labs</div> </div> </a> </div> </nav> <footer class="site-footer"> </footer> </div> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Basis Theory Guides" aria-label="Search Basis Theory Guides" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"> <use xlink:href="#svg-search"></use> </svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main" id="top"> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="run-your-own-code-in-a-reactor">Run Your Own Code in a Reactor</h1> <p>Basis Theory offers several pre-built Official Reactor Formulas that support standard integrations with popular Third Party systems. While these Official formulas are helpful to quickly get up and running for common use cases, we understand that every business has unique needs and challenges around how they use their data, and oftentimes custom code is required to achieve these goals. In this guide, we will walk through how to create a Private Reactor Formula to run your own custom code.</p> <p>If you are completely new to Reactors and would like to first learn the basics, check out our <a href="/concepts/what-are-reactors/">Reactors</a> concept page. If you’d rather learn about how to use one of our Official Reactor Formulas, check out our guide on how to <a href="/guides/use-token-data-in-reactors/">Use Token Data in Reactors</a>.</p> <h3 class="no_toc text-delta" id="table-of-contents">Table of contents</h3> <ol id="markdown-toc"> <li><a href="#how-to-configure-a-reactor-formula" id="markdown-toc-how-to-configure-a-reactor-formula">How to Configure a Reactor Formula</a></li> <li><a href="#how-to-write-code-for-a-reactor-formula" id="markdown-toc-how-to-write-code-for-a-reactor-formula">How to Write Code for a Reactor Formula</a> <ol> <li><a href="#importing-dependencies" id="markdown-toc-importing-dependencies">Importing Dependencies</a></li> <li><a href="#error-handling" id="markdown-toc-error-handling">Error Handling</a></li> </ol> </li> <li><a href="#creating-a-private-reactor-formula" id="markdown-toc-creating-a-private-reactor-formula">Creating a Private Reactor Formula</a></li> <li><a href="#using-our-private-reactor-formula" id="markdown-toc-using-our-private-reactor-formula">Using Our Private Reactor Formula</a></li> <li><a href="#wrapping-up" id="markdown-toc-wrapping-up">Wrapping Up</a></li> </ol> <h2 id="how-to-configure-a-reactor-formula">How to Configure a Reactor Formula</h2> <p>When defining a Reactor Formula, you have a few options for providing input data to be used within your custom code.</p> <p><a href="https://docs.basistheory.com/#reactor-formulas-reactor-formula-configuration">Configuration</a> is used to declare parameters that will be defined once per Reactor and do not change between Reactor invocations. Declare a configuration property on a Reactor Formula for each property you wish to be statically defined, such as an API key for a third-party API, or an environment variable.</p> <p><a href="https://docs.basistheory.com/#reactor-formulas-reactor-formula-request-parameters">Request Parameters</a> are used to declare parameters that will be provided with every Reactor invocation and are expected to vary between requests. Declare a request parameter on a Reactor Formula for each property you wish to supply at runtime, such as a user’s card number or a transaction amount.</p> <p>The <code class="language-plaintext highlighter-rouge">args</code> provided with each request to <a href="https://docs.basistheory.com/#reactors-invoke-a-reactor">invoke a Reactor</a> are validated against the request parameter declarations on the Reactor Formula. To access sensitive data within a Reactor Formula, tokens may be provided within the <code class="language-plaintext highlighter-rouge">args</code> to satisfy the request parameter contract - requests to invoke a Reactor are first <a href="https://docs.basistheory.com/expressions/#detokenization">detokenized</a> to replace any detokenization expressions within the <code class="language-plaintext highlighter-rouge">args</code> and the request provided to the Reactor Formula Code will contain your detokenized sensitive data.</p> <h2 id="how-to-write-code-for-a-reactor-formula">How to Write Code for a Reactor Formula</h2> <p>Reactors provide an isolated serverless Node.js v14 runtime in which your custom code is securely executed. Reactor Formulas are written using (Node.js v14-compatible) Javascript and have the following general structure:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">my_arg</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span> <span class="c1">// access any args provided with the request</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">MY_CONFIG</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">configuration</span><span class="p">;</span> <span class="c1">// access any static config defined on the Reactor</span>

  <span class="c1">// do anything here!</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">raw</span><span class="p">:</span> <span class="p">{},</span> <span class="c1">// non-sensitive data that should be returned in plaintext</span>
    <span class="na">tokenize</span><span class="p">:</span> <span class="p">{}</span> <span class="c1">// sensitive data that should be tokenized</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div> <p><span class="base-alert info"> <span> If you’re interested in writing custom Reactor Formulas using a language other than Javascript, please reach out and <a href="https://support.basistheory.com/hc/requests/new?tf_subject=Reactor%20Formula%20Language%20Request&amp;tf_description=Let%20us%20know%20what%20language%20you'd%20prefer&amp;tf_priority=normal" target="_blank">let us know</a>! </span> </span></p> <p>The <a href="https://docs.basistheory.com/#reactor-formulas-reactor-formula-code">request</a> object provided to a Reactor Formula contains the following properties:</p> <ul> <li><code class="language-plaintext highlighter-rouge">args</code>: <a href="https://docs.basistheory.com/expressions/#detokenization">detokenized</a> runtime arguments provided when invoking the Reactor <ul> <li><code class="language-plaintext highlighter-rouge">body</code>: when executing in the context of the <a href="https://docs.basistheory.com/#proxy">proxy</a>, this will contain the detokenized body of the request</li> <li><code class="language-plaintext highlighter-rouge">headers</code>: when executing in the context of the <a href="https://docs.basistheory.com/#proxy">proxy</a>, this will contain the headers of the request</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">configuration</code>: static <a href="https://docs.basistheory.com/#reactor-formulas-reactor-formula-configuration">configuration</a> defined with the Reactor</li> <li><code class="language-plaintext highlighter-rouge">bt</code>: a pre-configured Basis Theory JS instance for the <a href="https://docs.basistheory.com/#reactors-reactor-object">application</a> defined with the Reactor. This will be <code class="language-plaintext highlighter-rouge">null</code> if no application was defined</li> </ul> <p>The <a href="https://docs.basistheory.com/#reactor-formulas-reactor-formula-code">response</a> returned from a Reactor Formula may contain the following properties:</p> <ul> <li><code class="language-plaintext highlighter-rouge">raw</code>: non-sensitive data that will be returned in plaintext <ul> <li><code class="language-plaintext highlighter-rouge">body</code>: the <code class="language-plaintext highlighter-rouge">body</code> forwarded to the destination for the <a href="https://docs.basistheory.com/#proxy">proxy</a> request</li> <li><code class="language-plaintext highlighter-rouge">headers</code>: the <code class="language-plaintext highlighter-rouge">headers</code> to be forwarded to the destination for the <a href="https://docs.basistheory.com/#proxy">proxy</a> request</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">tokenize</code>: sensitive data that will be tokenized before returning it in the response</li> </ul> <p>Exercise caution when returning plaintext data within the <code class="language-plaintext highlighter-rouge">raw</code> portion of the response - the systems that invoke your Reactor will receive this raw data in the HTTP response and returning sensitive data in plaintext could result in these systems being pulled into compliance scope.</p> <p>While you have the freedom to author your Reactor Formula in any way you wish, we recommend that you strive to keep all sensitive data isolated within Basis Theory’s secure and compliant infrastructure. We generally recommend that any potentially sensitive output be tokenized in order to shield your systems.</p> <h3 id="importing-dependencies">Importing Dependencies</h3> <p>You are able to import dependencies within Reactor Formulas. For example, <code class="language-plaintext highlighter-rouge">node-fetch</code> can be imported into your code and used to make an HTTP request:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">card_number</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">API_KEY</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">configuration</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">node-fetch</span><span class="dl">'</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s2">`https://api.company.com/`</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> 
      <span class="dl">'</span><span class="s1">X-API-KEY</span><span class="dl">'</span><span class="p">:</span> <span class="nx">API_KEY</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
    <span class="p">},</span>
    <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">cardNumber</span><span class="p">:</span> <span class="nx">card_number</span> <span class="p">})</span>
  <span class="p">});</span>
    
  <span class="k">return</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div> <p>In order to ensure the security and integrity of the Reactor execution environment, only approved NPM packages can be used within Reactor Formulas. If you are interested in using a specific NPM package within your custom code, please <a href="https://support.basistheory.com/hc/requests/new?tf_subject=Request%20NPM%20Package%20for%20Private%20Reactor%20Formulas&amp;tf_description=Let%20us%20know%20what%20package%20you'd%20like%20to%20use&amp;tf_priority=normal">submit a request</a> to have this package reviewed and whitelisted.</p> <h3 id="error-handling">Error Handling</h3> <p>Many third party APIs or SDKs return errors in unique ways, so Reactor Formulas are expected to catch and handle any errors that occur during execution. Any errors that occur during the execution of your Reactor Formula should be caught, translated into a standard Basis Theory <a href="https://github.com/Basis-Theory/basistheory-reactor-formulas-sdk-js/tree/master/src/errors">Reactor error</a>, and this standardized error rethrown from the formula.</p> <p>The standard Basis Theory <a href="https://github.com/Basis-Theory/basistheory-reactor-formulas-sdk-js/tree/master/src/errors">Reactor errors</a> are defined within the NPM package <a href="https://www.npmjs.com/package/@basis-theory/basis-theory-reactor-formulas-sdk-js">@basis-theory/basistheory-reactor-formulas-sdk-js</a>, which is available to import from within your Reactor Formulas. These standard error types will be translated by the Reactor execution environment into <a href="https://docs.basistheory.com/#errors-reactor-errors">HTTP errors</a> returned from the Basis Theory API. Any other uncaught exceptions thrown from a Reactor Formula will be returned as a generic HTTP <code class="language-plaintext highlighter-rouge">500</code> error and the original error message will be lost. The Reactor Formula will be retried up to 3 times in the event of any transient errors (an HTTP status code <code class="language-plaintext highlighter-rouge">&gt;=500</code> or <code class="language-plaintext highlighter-rouge">408 Request Timeout</code>).</p> <p>As an example, if you are working with an API that returns errors indicated by HTTP response status codes, your formula can translate from these potentially vendor-specific status codes to a standard Basis Theory error as follows:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span>
    <span class="nx">AuthenticationError</span><span class="p">,</span>
    <span class="nx">BadRequestError</span><span class="p">,</span>
    <span class="nx">ReactorRuntimeError</span><span class="p">,</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@basis-theory/basis-theory-reactor-formulas-sdk-js</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">node-fetch</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(...);</span>
  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span> <span class="o">!==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">AuthenticationError</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
      <span class="k">case</span> <span class="mi">400</span><span class="p">:</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">BadRequestError</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">ReactorRuntimeError</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// ...</span>
<span class="p">};</span>
</code></pre></div></div> <p>Any object or array passed into the constructor of a standard Basis Theory Reactor error will be returned in the <code class="language-plaintext highlighter-rouge">errors</code> property of the HTTP response when invoking the Reactor. Use caution when returning data through <code class="language-plaintext highlighter-rouge">errors</code>, as it will be returned in plaintext and not be tokenized or masked.</p> <h2 id="creating-a-private-reactor-formula">Creating a Private Reactor Formula</h2> <p>As an example, we will be creating a custom Reactor Formula that interacts with the <a href="https://docs.lithic.com/docs/cards#create-card">Lithic API</a> to issue a credit card from our hypothetical company’s corporate Lithic account.</p> <p>We will allow setting a single configuration parameter with this Reactor, the API key issued by Lithic for our account:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Type</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">LITHIC_API_KEY</td> <td style="text-align: left">string</td> <td style="text-align: left">The api key issued by Lithic</td> </tr> </tbody> </table></div> <p>We will also allow requests to our Reactor to specify several parameters that we will forward to the Lithic API to control the name of our new card, the type of card to create, and the spend limit of the card:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Type</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">memo</td> <td style="text-align: left">string</td> <td style="text-align: left">The name to identify the card</td> </tr> <tr> <td style="text-align: left">type</td> <td style="text-align: left">string</td> <td style="text-align: left">The type of card to issue (<a href="https://docs.lithic.com/docs/cards#cardtype">see Lithic docs</a>)</td> </tr> <tr> <td style="text-align: left">spend_limit</td> <td style="text-align: left">number</td> <td style="text-align: left">The amount (in cents) to limit approved authorizations</td> </tr> <tr> <td style="text-align: left">spend_limit_duration</td> <td style="text-align: left">string</td> <td style="text-align: left">Duration for which spend limit applies (<a href="https://docs.lithic.com/docs/cards#cardspend_limit_duration">see Lithic docs</a></td> </tr> </tbody> </table></div> <p>We can then use these configuration and request parameters in our Reactor Formula code to make an API request to Lithic. We will also create a <code class="language-plaintext highlighter-rouge">card</code> token as output from this Reactor using the card details provided to us in the Lithic API response.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">LITHIC_API_KEY</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">configuration</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">memo</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">spend_limit</span><span class="p">,</span> <span class="nx">spend_limit_duration</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">args</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">node-fetch</span><span class="dl">'</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">memo</span><span class="p">,</span>
    <span class="nx">type</span><span class="p">,</span>
    <span class="nx">spend_limit</span><span class="p">,</span>
    <span class="nx">spend_limit_duration</span><span class="p">,</span>
    <span class="na">state</span><span class="p">:</span> <span class="dl">'</span><span class="s1">OPEN</span><span class="dl">'</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span>
    <span class="s2">`https://sandbox.lithic.com/v1/card`</span><span class="p">,</span>
    <span class="p">{</span>
      <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">),</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> 
        <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="s2">`api-key </span><span class="p">${</span><span class="nx">LITHIC_API_KEY</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">);</span>
  <span class="c1">// omitted for brevity: translate response status codes to Basis Theory Reactor errors</span>
    
  <span class="kd">const</span> <span class="nx">lithicCard</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

  <span class="k">return</span> <span class="p">{</span> 
    <span class="na">tokenize</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">card</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">number</span><span class="p">:</span> <span class="nx">lithicCard</span><span class="p">.</span><span class="nx">pan</span><span class="p">,</span>
        <span class="na">expiration_month</span><span class="p">:</span> <span class="nx">lithicCard</span><span class="p">.</span><span class="nx">exp_month</span><span class="p">,</span>
        <span class="na">expiration_year</span><span class="p">:</span> <span class="nx">lithicCard</span><span class="p">.</span><span class="nx">exp_year</span><span class="p">,</span>
        <span class="na">cvc</span><span class="p">:</span> <span class="nx">lithicCard</span><span class="p">.</span><span class="nx">cvv</span>
      <span class="p">},</span>
      <span class="na">metadata</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">lithic_token_id</span><span class="p">:</span> <span class="nx">lithicCard</span><span class="p">.</span><span class="nx">token</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div> <p>Next, we need to create a Private Reactor Formula in Basis Theory containing this <code class="language-plaintext highlighter-rouge">code</code>, <code class="language-plaintext highlighter-rouge">configuration</code>, and <code class="language-plaintext highlighter-rouge">request_parameters</code> by calling the <a href="https://docs.basistheory.com/#reactor-formulas-create-reactor-formula">Create Reactor Formula</a> API. Note that all newline characters must be escaped as <code class="language-plaintext highlighter-rouge">\n</code> within the <code class="language-plaintext highlighter-rouge">code</code> property of the JSON request:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s1">'https://api.basistheory.com/reactor-formulas'</span> <span class="se">\</span>
  <span class="nt">-X</span> <span class="s1">'POST'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'BT-API-KEY: key_PtkNaBwXe23rGt1eZenMMx'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
      "name": "Lithic - Issue Card",
      "description": "Issues a new card using Lithic",
      "type": "private",
      "code": "module.exports = async function (req) {\n    const { LITHIC_API_KEY } = req.configuration;\n    const { memo, type, spend_limit, spend_limit_duration } = req.args;\n  \n    const fetch = require('</span>node-fetch<span class="s1">');\n  \n    const body = {\n      memo,\n      type,\n      spend_limit,\n      spend_limit_duration,\n      state: '</span>OPEN<span class="s1">'\n    };\n  \n    const response = await fetch(\n      `https://sandbox.lithic.com/v1/card`,\n      {\n        method: '</span>post<span class="s1">',\n        body: JSON.stringify(body),\n        headers: { \n          '</span>Authorization<span class="s1">': `api-key ${LITHIC_API_KEY}`,\n          '</span>Content-Type<span class="s1">': '</span>application/json<span class="s1">',\n        }\n      }\n    );\n    const lithicCard = await response.json();\n  \n    return { \n      tokenize: {\n        type: '</span>card<span class="s1">',\n        data: {\n          number: lithicCard.pan,\n          expiration_month: lithicCard.exp_month,\n          expiration_year: lithicCard.exp_year,\n          cvc: lithicCard.cvv\n        },\n        metadata: {\n          lithic_token_id: lithicCard.token\n        }\n      }\n    };\n  }\n",
      "configuration": [
          {
              "name": "LITHIC_API_KEY",
              "description": "The api key issued by Lithic",
              "type": "string"
          }
      ],
      "request_parameters": [
          {
              "name": "memo",
              "description": "The name to identify the card",
              "type": "string",
              "optional": false
          },
          {
              "name": "type",
              "description": "The type of card to issue",
              "type": "string",
              "optional": false
          },
          {
              "name": "spend_limit",
              "description": "The amount (in cents) to limit approved authorizations",
              "type": "number",
              "optional": true
          },
          {
              "name": "spend_limit_duration",
              "description": "Duration for which spend limit applies",
              "type": "string",
              "optional": true
          }
      ]
  }'</span>
</code></pre></div></div> <p>The API will respond with the <code class="language-plaintext highlighter-rouge">id</code> of our new Private Reactor Formula:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"886f14ab-9404-444e-ae44-848c87d1ff88"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"private"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lithic - Issue Card"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Issues a new card using Lithic"</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="using-our-private-reactor-formula">Using Our Private Reactor Formula</h2> <p>Next, we will use this Reactor Formula to <a href="https://docs.basistheory.com/#reactors-create-reactor">create a Reactor</a> that contains the <code class="language-plaintext highlighter-rouge">LITHIC_API_KEY</code> to interact on behalf of our company’s Lithic account:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s1">'https://api.basistheory.com/reactors'</span> <span class="se">\</span>
  <span class="nt">-X</span> <span class="s1">'POST'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'BT-API-KEY: key_PtkNaBwXe23rGt1eZenMMx'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
      "name": "Lithic - Issue Card from My Company",
      "configuration": {
        "LITHIC_API_KEY": "02f0a915-6226-4a8b-861e-58b08984106f"
      },
      "formula": {
        "id": "886f14ab-9404-444e-ae44-848c87d1ff88"
      }
  }'</span>
</code></pre></div></div> <p>The Basis Theory API will respond with the <code class="language-plaintext highlighter-rouge">id</code> of our new Reactor, which we will use later to invoke our Reactor:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ab8a1c9a-8666-449d-91c7-6c0d77bf7d02"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lithic - Issue Card from My Company"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"LITHIC_API_KEY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"02f0a915-6226-4a8b-861e-58b08984106f"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"formula"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Now that we have created a Reactor that uses our private formula, we can now make requests to it. We will use the <a href="https://docs.basistheory.com/#reactors-invoke-a-reactor">Invoke a Reactor</a> endpoint with <code class="language-plaintext highlighter-rouge">args</code> that instruct our Reactor to issue a card called <code class="language-plaintext highlighter-rouge">John's Travel Card</code> with a total spending limit of $500.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s1">'https://api.basistheory.com/reactors/ab8a1c9a-8666-449d-91c7-6c0d77bf7d02/react'</span> <span class="se">\</span>
  <span class="nt">-X</span> <span class="s1">'POST'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'BT-API-KEY: key_PtkNaBwXe23rGt1eZenMMx'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
      "args": {
        "memo": "John'</span><span class="se">\'</span><span class="s1">'s Travel Card",
        "type": "UNLOCKED",
        "spend_limit": 50000,
        "spend_limit_duration": "FOREVER"
      }
  }'</span>
</code></pre></div></div> <p>The Basis Theory API will respond with a newly created <code class="language-plaintext highlighter-rouge">card</code> token that contains the card details issued by Lithic.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"tokens"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"27ca2332-826f-4064-935a-603bfc5d8fb0"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XXXXXXXXXXXX8208"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"expiration_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="nl">"expiration_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2028</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"lithic_token_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"de9fd4cf-fd5b-4ebc-8a25-3a564bc375c2"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="wrapping-up">Wrapping Up</h2> <p>We’ve seen how to create Private Reactor Formulas to run your own code within Basis Theory’s serverless Reactor infrastructure. By bringing your own code, you have the flexibility to use your token data however you need - the possibilities of what you can do with Reactors are virtually unlimited.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
